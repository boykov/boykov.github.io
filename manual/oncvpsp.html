<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
<!-- 2016-12-07 Ср. 15:41 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title>Установка и использование пакета oncvpsp</title>
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="../org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<style type="text/css">.org-src-name{ text-align: right; }</style>
<style type="text/css">.outline-2{ margin-top: 60px; }</style>

<style type="text/css">
  pre.src:before {
    top: -5px;
  }
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Установка и использование пакета oncvpsp</h1>


<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3"><span class="section-number-2">1</span> Установка пакета</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-orgheadline1" class="outline-3">
<h3 id="orgheadline1"><span class="section-number-3">1.1</span> Установка libxc</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">

<pre class="src src-sh">mkdir -p /opt/libxc/2.2.3

<span style="color: #657b83; font-weight: bold;">cd</span> install

wget http://www.tddft.org/programs/octopus/down.php?<span style="color: #268bd2;">file</span>=libxc/libxc-2.2.3.tar.gz
tar -zxvf libxc-2.2.3.tar.gz

<span style="color: #657b83; font-weight: bold;">cd</span> libxc-2.2.3
./configure --prefix=/opt/libxc/2.2.3 <span style="color: #268bd2;">FC</span>=gfortran44
make
make check
sudo make install
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2"><span class="section-number-3">1.2</span> Установка oncvpsp</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">

<pre class="src src-sh">mkdir -p /opt/oncvpsp/3.2.3

wget http://www.mat-simresearch.com/oncvpsp-3.2.3.tar.gz
tar -zxvf oncvpsp-3.2.3.tar.gz

<span style="color: #657b83; font-weight: bold;">cd</span> ../oncvpsp-3.2.3
sed -i <span style="color: #2aa198;">"s/^F77        = gfortran/F77        = gfortran44/g"</span> make.inc
sed -i <span style="color: #2aa198;">"s/^F90        = gfortran/F90        = gfortran44/g"</span> make.inc
sed -i <span style="color: #2aa198;">"s|^LIBS = -L/usr/local/lapack/lib -llapack -lrefblas|LIBS = -L/opt/intel/mkl/10.2.5.035/lib/em64t -lmkl_rt|g"</span> make.inc
sed -i <span style="color: #2aa198;">"s|^#LIBS += -L/home/drh/abinit/fallbacks/exports/lib -lxcf90 -lxc|LIBS += -L/opt/libxc/2.2.3/lib -lxcf90 -lxc|g"</span> make.inc
sed -i <span style="color: #2aa198;">"s|^#FFLAGS += -I/home/drh/abinit/fallbacks/exports/include|FFLAGS += -I/opt/libxc/2.2.3/include|g"</span> make.inc
sed -i <span style="color: #2aa198;">"s|^#OBJS_LIBXC|OBJS_LIBXC|g"</span> make.inc
make all &gt;&amp;make.log
cp src/*.x /opt/oncvpsp/3.2.3/
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name">Изменения в файле make.inc</label>
<pre class="src src-diff"><span style="color: #93a1a1;">commit 5b5c2dd478beb13a58f936d9da5c7e29112b50b7</span>
<span style="color: #93a1a1;">Author: Evgeny Boykov <a href="mailto:boykov%40mercury.febras.net">&lt;boykov@mercury.febras.net&gt;</a></span>
<span style="color: #93a1a1;">Date:   Wed Dec 7 15:04:20 2016 +1000</span>

<span style="color: #93a1a1;">    fix make.inc</span>

<span style="color: #93a1a1;">diff --git a/make.inc b/make.inc</span>
<span style="color: #93a1a1;">index e5e39e5..8100bc3 100644</span>
<span style="background-color: #fdf6e3;">--- </span><span style="color: #657b83; background-color: #fdf6e3; font-weight: bold;">a/make.inc</span>
<span style="background-color: #fdf6e3;">+++ </span><span style="color: #657b83; background-color: #fdf6e3; font-weight: bold;">b/make.inc</span>
<span style="background-color: #fdf6e3;">@@ -6,8 +6,8 @@</span>
<span style="color: #93a1a1;">  </span>
<span style="color: #93a1a1;"> ##### Edit the following lines to correspond to your compilers ####</span>
<span style="color: #93a1a1;"> </span>
<span style="color: #dc322f;">-</span><span style="color: #dc322f;">F77        = gfortran</span>
<span style="color: #dc322f;">-</span><span style="color: #dc322f;">F90        = gfortran</span>
<span style="color: #859900;">+</span><span style="color: #859900;">F77        = gfortran44</span>
<span style="color: #859900;">+</span><span style="color: #859900;">F90        = gfortran44</span>
<span style="color: #93a1a1;"> CC         = gcc</span>
<span style="color: #93a1a1;"> FCCPP      = cpp</span>
<span style="color: #93a1a1;"> </span>
<span style="background-color: #fdf6e3;">@@ -22,7 +22,7 @@</span><span style="background-color: #fdf6e3;"> CFLAGS     = -O3</span>
<span style="color: #93a1a1;"> </span>
<span style="color: #93a1a1;"> ##### Edit the following LAPACK and BLAS library paths for your system ####</span>
<span style="color: #93a1a1;"> </span>
<span style="color: #dc322f;">-</span><span style="color: #dc322f;">LIBS = -L/usr/local/lapack/lib -llapack -lrefblas</span>
<span style="color: #859900;">+</span><span style="color: #859900;">LIBS = -L/opt/intel/mkl/10.2.5.035/lib/em64t -lmkl_rt</span>
<span style="color: #93a1a1;"> </span>
<span style="color: #93a1a1;"> ##### Edit the following for to use libxc if available #####</span>
<span style="color: #93a1a1;"> </span>
<span style="background-color: #fdf6e3;">@@ -34,11 +34,11 @@</span><span style="background-color: #fdf6e3;"> OBJS_LIBXC =        exc_libxc_stub.o</span>
<span style="color: #93a1a1;"> # make clean in src before rebuilding after changing this</span>
<span style="color: #93a1a1;"> </span>
<span style="color: #93a1a1;"> ##for libxc 2.1.0 and later use</span>
<span style="color: #dc322f;">-</span><span style="color: #dc322f;">#LIBS += -L/home/drh/abinit/fallbacks/exports/lib -lxcf90 -lxc</span>
<span style="color: #859900;">+</span><span style="color: #859900;">LIBS += -L/opt/libxc/2.2.3/lib -lxcf90 -lxc</span>
<span style="color: #93a1a1;"> </span>
<span style="color: #93a1a1;"> ##for earlier releases use</span>
<span style="color: #93a1a1;"> #LIBS += -L/home/drh/abinit/fallbacks/exports/lib -lxc</span>
<span style="color: #93a1a1;"> </span>
<span style="color: #dc322f;">-</span><span style="color: #dc322f;">#FFLAGS += -I/home/drh/abinit/fallbacks/exports/include</span>
<span style="color: #dc322f;">-</span><span style="color: #dc322f;">#OBJS_LIBXC =  functionals.o exc_libxc.o </span>
<span style="color: #859900;">+</span><span style="color: #859900;">FFLAGS += -I/opt/libxc/2.2.3/include</span>
<span style="color: #859900;">+</span><span style="color: #859900;">OBJS_LIBXC =   functionals.o exc_libxc.o</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">2</span> Использование пакета</h2>
<div class="outline-text-2" id="text-2">
<p>
Команда <code>make all</code> также запускает на выполнение тесты. Все тесты пройдены успешно.
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #657b83; font-weight: bold;">cd</span> tests/data ; ./TEST.sh
cat tests/data/TEST.report
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name">Результат выполнения тестов</label>
<pre class="src src-raw">03_Li.diff:Summary  : no significant difference has been found
07_N.diff:Summary  : different lines= 8 , max abs_diff= 1.000e-07 (l.334), max rel_diff= 2.092e-08 (l.306)
08_O.diff:Summary  : different lines= 2 , max abs_diff= 1.000e-07 (l.394), max rel_diff= 1.039e-08 (l.394)
14_Si.diff:Summary  : different lines= 5 , max abs_diff= 1.000e-07 (l.648), max rel_diff= 1.139e-06 (l.750)
14_Si_GHOST.diff:Summary  : different lines= 4 , max abs_diff= 1.000e-07 (l.659), max rel_diff= 1.954e-07 (l.745)
14_Si_st.diff:Summary  : no significant difference has been found
14_Si_UPF.diff:Summary  : different lines= 5 , max abs_diff= 1.000e-07 (l.648), max rel_diff= 1.139e-06 (l.750)
17_Cl.diff:Summary  : no significant difference has been found
19_K.diff:Summary  : different lines= 2 , max abs_diff= 1.000e-02 (l.224), max rel_diff= 2.367e-04 (l.224)
19_K_st.diff:Summary  : no significant difference has been found
20_Ca.diff:Summary  : no significant difference has been found
22_Ti.diff:Summary  : no significant difference has been found
29_Cu.diff:Summary  : no significant difference has been found
32_Ge.diff:Summary  : no significant difference has been found
34_Se.diff:Summary  : different lines= 11 , max abs_diff= 3.899e-02 (l.8178), max rel_diff= 6.135e-01 (l.8178)
38_Sr.diff:Summary  : different lines= 2 , max abs_diff= 1.000e-02 (l.227), max rel_diff= 3.306e-04 (l.227)
40_Zr.diff:Summary  : different lines= 25 , max abs_diff= 2.180e-01 (l.9125), max rel_diff= 1.000e+00 (l.9125)
52_Te_r.diff:Summary  : different lines= 4 , max abs_diff= 1.000e-02 (l.472), max rel_diff= 1.778e-04 (l.472)
56_Ba.diff:Summary  : different lines= 2 , max abs_diff= 1.000e-02 (l.305), max rel_diff= 1.778e-04 (l.305)
57_La.diff:Summary  : no significant difference has been found
74_W_r.diff:Summary  : no significant difference has been found
79_Au_r.diff:Summary  : different lines= 16 , max abs_diff= 1.885e+00 (l.17480), max rel_diff= 3.096e-01 (l.17480)
80_Hg_r.diff:Summary  : different lines= 6 , max abs_diff= 1.000e-02 (l.483), max rel_diff= 4.938e-04 (l.483)
83_Bi.diff:Summary  : no significant difference has been found
</pre>
</div>
</div>
</div>
</div>
</body>
</html>
